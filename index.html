<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KssS Restaurant QR POS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff}
header{background:#000;padding:12px;text-align:center}
h2{margin:0;color:#ffd700}
.tableBox{text-align:center;margin:6px 0}

.category{background:#d32f2f;padding:8px;margin-top:15px;text-align:center;font-weight:bold}
.item{border-bottom:1px solid #333;padding:10px}

.foodImg{
width:100%;max-height:140px;
object-fit:cover;border-radius:6px;margin-bottom:6px
}

.top{display:flex;justify-content:space-between;align-items:center}

.plate button{
padding:4px 8px;margin-right:5px;
border:none;border-radius:4px;
background:#444;color:#fff
}
.plate button.active{background:#2e7d32}

.qty{
display:flex;justify-content:space-between;
align-items:center;margin-top:6px
}
.qty button{
padding:4px 8px;background:#ff9800;
border:none;border-radius:4px
}

.total{font-size:22px;text-align:center;margin:15px;color:#0f0}

.place{
width:90%;margin:auto;display:block;
font-size:18px;padding:10px;
background:#d32f2f;color:#fff;
border:none;border-radius:6px
}

.adminBtn{
width:90%;margin:8px auto;display:block;
font-size:16px;padding:8px;
background:#555;color:#fff;
border:none;border-radius:6px
}

.container{max-width:520px;margin:auto}
footer{text-align:center;font-size:14px;padding:8px;background:#000}
</style>
</head>

<body>

<header>
<h2>KssS Restaurant – 100% Veg</h2>
</header>

<div class="tableBox">
Table No: <b id="tableNo">N/A</b>
</div>

<div class="container">
<button class="adminBtn" onclick="toggleAdmin()">ADMIN PANEL</button>

<div id="menu"></div>

<div class="total">Total ₹ <span id="total">0</span></div>
<button class="place" onclick="placeOrder()">Place Order</button>
</div>

<footer>QR POS System</footer>

<script>
/* ===== TABLE ===== */
const p=new URLSearchParams(location.search);
let tableNo=p.get("table")||"N/A";
document.getElementById("tableNo").innerText=tableNo;

/* ===== MENU DATA (FULL MENU CAN BE EXTENDED) ===== */
let menuData=[
{category:"Chinese",items:[
{name:"Veg Chowmein",half:40,full:70,enable:true},
{name:"Paneer Chowmein",half:60,full:120,enable:true},
{name:"Veg Momos",half:40,full:80,enable:true},
{name:"Paneer Momos",half:50,full:100,enable:true}
]},
{category:"Pizza",items:[
{name:"Cheese Pizza",price:120,enable:true},
{name:"Paneer Pizza",price:180,enable:true}
]},
{category:"Dosa",items:[
{name:"Masala Dosa",price:80,enable:true},
{name:"Paneer Dosa",price:120,enable:true}
]},
{category:"Drinks",items:[
{name:"Tea",price:15,enable:true},
{name:"Cold Coffee",price:90,enable:true}
]}
];

let cart={},total=0;
let adminMode=false;
const menu=document.getElementById("menu");
const totalBox=document.getElementById("total");

function img(name){
return `https://source.unsplash.com/600x400/?${encodeURIComponent(name+" food")}`;
}

/* ===== LOAD MENU ===== */
function loadMenu(){
menu.innerHTML="";
cart={};

menuData.forEach(c=>{
menu.innerHTML+=`<div class="category">${c.category}</div>`;
c.items.forEach(i=>{
if(!i.enable&&!adminMode)return;

const id=i.name.replace(/\s/g,"_");
cart[id]={name:i.name,qty:0,price:0,plate:""};

let priceUI="",plateUI="";
if(i.half){
priceUI=`₹${i.half} / ₹${i.full}`;
plateUI=`
<div class="plate">
<button onclick="setPlate('${id}','Half',${i.half},this)">Half</button>
<button onclick="setPlate('${id}','Full',${i.full},this)">Full</button>
</div>`;
}else{
priceUI=`₹${i.price}`;
cart[id].price=i.price;
cart[id].plate="Full";
}

menu.innerHTML+=`
<div class="item">
<img class="foodImg" src="${img(i.name)}">
<div class="top">
<b>${i.name}</b>
<span>${priceUI}</span>
</div>
${plateUI}
<div class="qty">
<button onclick="qty('${id}',-1)">−</button>
<span id="q_${id}">0</span>
<button onclick="qty('${id}',1)">+</button>
</div>
${adminMode?`
<div>
<label>Enable <input type="checkbox" ${i.enable?"checked":""}
onchange="iEnable('${c.category}','${i.name}',this.checked)"></label>
</div>`:""}
</div>`;
});
});
}

/* ===== CART ===== */
function setPlate(id,plate,price,btn){
cart[id].price=price;
cart[id].plate=plate;
btn.parentNode.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
calc();
}
function qty(id,d){
cart[id].qty=Math.max(0,cart[id].qty+d);
document.getElementById("q_"+id).innerText=cart[id].qty;
calc();
}
function calc(){
total=0;
Object.values(cart).forEach(i=>total+=i.price*i.qty);
totalBox.innerText=total;
}

/* ===== ADMIN ===== */
function toggleAdmin(){
adminMode=!adminMode;
loadMenu();
}
function iEnable(cat,name,val){
menuData.forEach(c=>{
if(c.category==cat){
c.items.forEach(i=>{if(i.name==name)i.enable=val;});
}
});
}

/* ===== BILL + KITCHEN (THERMAL) ===== */
function placeOrder(){
if(total==0){alert("No items selected");return;}

let bill="",kitchen="";
Object.values(cart).forEach(i=>{
if(i.qty>0){
bill+=`${i.name} (${i.plate}) x${i.qty} = ₹${i.qty*i.price}<br>`;
kitchen+=`${i.name} (${i.plate}) x${i.qty}<br>`;
}
});

/* BILL */
let b=window.open("");
b.document.write(`
<body style="font-family:monospace;width:260px">
<center><b>KssS Restaurant</b></center>
<hr>Table: ${tableNo}<br>
${bill}
<hr><b>Total: ₹${total}</b>
<script>window.print()</script>
</body>
`);
b.document.close();

/* KITCHEN */
let k=window.open("");
k.document.write(`
<body style="font-family:monospace;width:260px">
<center><b>KITCHEN SLIP</b></center>
<hr>Table: ${tableNo}<br>
${kitchen}
<hr>
<script>window.print()</script>
</body>
`);
k.document.close();

/* RESET */
loadMenu();
totalBox.innerText=0;
}

loadMenu();
</script>

</body>
</html>
