<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KssS Restaurant QR POS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff}
header{background:#000;padding:12px;text-align:center}
h2{margin:0;color:#ffd700}

.tableBox{text-align:center;margin-top:6px;font-size:16px}

.category{background:#d32f2f;padding:8px;margin-top:15px;text-align:center;font-weight:bold}
.item{border-bottom:1px solid #333;padding:8px}
.top{display:flex;justify-content:space-between;margin-bottom:6px}

.plate button{padding:4px 6px;margin-right:5px;border:none;border-radius:4px;background:#555;color:#fff}
.plate button.active{background:#388e3c}

.qty{display:flex;justify-content:space-between;align-items:center;margin-top:6px}
.qty button{padding:4px 8px;background:#ff9800;border:none;color:#000;border-radius:4px}
.qty span{min-width:22px;text-align:center}

.pack{font-size:14px}

.total{font-size:22px;text-align:center;margin:15px;color:#0f0}
.place{width:90%;margin:auto;display:block;font-size:18px;padding:10px;background:#d32f2f;color:#fff;border:none;border-radius:6px}

.container{max-width:520px;margin:auto}
footer{text-align:center;font-size:14px;padding:8px;background:#000}
</style>
</head>

<body>

<header>
<h2>KssS Restaurant â€“ 100% Veg</h2>
</header>

<div class="tableBox">
Table No: <b id="tableNo">N/A</b>
</div>

<div class="container">
<div id="menu"></div>

<div class="total">Total â‚¹ <span id="total">0</span></div>
<button class="place" onclick="placeOrder()">Place Order</button>
</div>

<footer>QR POS System</footer>

<script>
/* ===== TABLE (FORCE SAFE) ===== */
const urlParams = new URLSearchParams(window.location.search);
let tableNo = "N/A";
const t = parseInt(urlParams.get("table"),10);
if(!isNaN(t) && t>=1 && t<=8) tableNo = t;
document.getElementById("tableNo").innerText = tableNo;

/* ===== MENU ===== */
const menuData=[
{category:"ðŸ¥¢ Chinese",items:[
{name:"Veg Chowmein",price:60},
{name:"Paneer Chowmein",price:80}
]},
{category:"ðŸ• Pizza",items:[
{name:"Cheese Pizza",price:120}
]}
];

let cart={}, total=0;
const menuDiv=document.getElementById("menu");
const totalSpan=document.getElementById("total");

function loadMenu(){
menuDiv.innerHTML="";
cart={};
menuData.forEach(cat=>{
menuDiv.innerHTML+=`<div class="category">${cat.category}</div>`;
cat.items.forEach(i=>{
const id=i.name.replace(/\s/g,"");
cart[id]={name:i.name,price:i.price,qty:0,pack:false};
menuDiv.innerHTML+=`
<div class="item">
<div class="top"><b>${i.name}</b><span>â‚¹${i.price}</span></div>
<div class="qty">
<button onclick="qty('${id}',-1)">âˆ’</button>
<span id="q_${id}">0</span>
<button onclick="qty('${id}',1)">+</button>
<label class="pack">
<input type="checkbox" onchange="cart['${id}'].pack=this.checked"> ðŸ“¦
</label>
</div>
</div>`;
});
});
}

function qty(id,d){
cart[id].qty=Math.max(0,cart[id].qty+d);
document.getElementById("q_"+id).innerText=cart[id].qty;
calc();
}

function calc(){
total=0;
Object.values(cart).forEach(i=>total+=i.price*i.qty);
totalSpan.innerText=total;
}

/* ===== PRINT / BILL (HARD LOCKED HEADER) ===== */
function placeOrder(){
if(total===0){alert("No items selected");return;}

const now=new Date();
const dt=now.toLocaleString();

let rows="";
Object.values(cart).forEach(i=>{
if(i.qty>0){
rows+=`<div>${i.pack?"ðŸ“¦ ":""}${i.name} Ã— ${i.qty} @ â‚¹${i.price} = â‚¹${i.price*i.qty}</div>`;
}
});

const w=window.open("","_blank");
w.document.write(`
<!DOCTYPE html>
<html>
<head>
<title>Bill</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{font-family:Arial;padding:10px;color:#000}
h1,h2{text-align:center;margin:2px 0}
hr{margin:6px 0}
button{width:100%;padding:12px;font-size:18px;margin-top:15px}
</style>
</head>
<body>

<h1>KssS Restaurant</h1>
<h2>100% Veg</h2>
<hr>
<b>Date:</b> ${dt}<br>
<b>Table:</b> ${tableNo}
<hr>
${rows}
<hr>
<b>TOTAL: â‚¹${total}</b>

<button onclick="window.print()">PRINT</button>

</body>
</html>
`);
w.document.close();

loadMenu();
total=0;
totalSpan.innerText=0;
}

loadMenu();
</script>

</body>
</html>
