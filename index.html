<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KssS Restaurant QR POS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff}
header{background:#000;padding:12px;text-align:center}
h2{margin:0;color:#ffd700}

.tableBox{text-align:center;margin-top:6px;font-size:16px}

.category{background:#d32f2f;padding:8px;margin-top:15px;text-align:center;font-weight:bold}

.item{border-bottom:1px solid #333;padding:8px}

.top{display:flex;justify-content:space-between;margin-bottom:6px}

.plate button{
padding:4px 6px;margin-right:5px;
border:none;border-radius:4px;
background:#555;color:#fff;font-size:13px
}
.plate button.active{background:#388e3c}

.qty{
display:flex;
justify-content:space-between;
align-items:center;
margin-top:6px
}

.qty button{
padding:4px 8px;
background:#ff9800;border:none;
color:#000;border-radius:4px;font-weight:bold
}
.qty span{min-width:22px;text-align:center}

.pack{font-size:14px}

.total{font-size:22px;text-align:center;margin:15px;color:#0f0}

.place{
width:90%;
margin:auto;
display:block;
font-size:18px;
padding:10px;
background:#d32f2f;
color:#fff;border:none;
border-radius:6px
}

.adminBtn{text-align:center;margin-top:10px}

.admin{
display:none;
background:#000;
margin:10px;
padding:10px;
border:1px solid #333
}
.admin h3{color:#ffd700;margin-top:0}

.priceRow{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:6px;
font-size:14px
}
.priceRow input{
width:60px;
padding:3px
}

.stat{border-bottom:1px solid #333;padding:6px 0}

.reset{
background:#ff5252;
border:none;
color:#fff;
padding:6px 10px;
border-radius:4px;
margin-top:10px
}

.container{max-width:520px;margin:auto}
footer{text-align:center;font-size:14px;padding:8px;background:#000}
</style>
</head>

<body>

<header>
<h2>KssS Restaurant â€“ 100% Veg</h2>
</header>

<div class="tableBox">
Table No: <b id="tableNo">N/A</b>
</div>

<div class="container">

<div id="menu"></div>

<div class="total">Total â‚¹ <span id="total">0</span></div>
<button class="place" onclick="placeOrder()">Place Order</button>

<div class="adminBtn">
<button onclick="adminLogin()">Admin Panel</button>
</div>

<div class="admin" id="admin">
<h3>ADMIN PRICE EDIT</h3>
<div id="priceEdit"></div>

<h3>DAILY SUMMARY</h3>
<div class="stat">Orders Today: <b id="orderCount">0</b></div>
<div class="stat">Total Sales: â‚¹ <b id="salesTotal">0</b></div>
<button class="reset" onclick="resetDaily()">Reset Daily Data</button>
</div>

</div>

<footer>QR POS System</footer>

<script>
/* TABLE LOGIC */
const params=new URLSearchParams(location.search);
let tableNo=params.get("table");
if(!(tableNo>=1 && tableNo<=8)) tableNo="N/A";
document.getElementById("tableNo").innerText=tableNo;

/* MENU (LOAD OR DEFAULT) */
let defaultMenu=[
{category:"ðŸ¥¢ Chinese",items:[
{name:"Veg Chowmein",price:60},
{name:"Paneer Chowmein",price:80},
{name:"Veg Steam Momos",price:80},
{name:"Paneer Steam Momos",price:100}
]},
{category:"ðŸ• Pizza",items:[
{name:"Cheese Pizza",price:120},
{name:"Paneer Pizza",price:180}
]},
{category:"ðŸ” Snacks",items:[
{name:"Veg Burger",price:30},
{name:"Paneer Burger",price:40},
{name:"French Fries",price:50}
]}
];

let menuData=JSON.parse(localStorage.getItem("menuData"))||defaultMenu;

let cart={},total=0;
let sales=Number(localStorage.getItem("sales"))||0;
let orders=Number(localStorage.getItem("orders"))||0;

const menuDiv=document.getElementById("menu");
const totalSpan=document.getElementById("total");

/* LOAD MENU */
function loadMenu(){
menuDiv.innerHTML="";
cart={};
menuData.forEach(cat=>{
menuDiv.innerHTML+=`<div class="category">${cat.category}</div>`;
cat.items.forEach(i=>{
let id=i.name.replace(/\s/g,'');
cart[id]={name:i.name,price:i.price,qty:0,pack:false};
menuDiv.innerHTML+=`
<div class="item">
<div class="top">
<b>${i.name}</b><span>â‚¹${i.price}</span>
</div>

<div class="plate">
<button class="active" onclick="setPlate('${id}',${i.price},this)">Full</button>
<button onclick="setPlate('${id}',${i.price*0.6},this)">Half</button>
</div>

<div class="qty">
<div>
<button onclick="qty('${id}',-1)">âˆ’</button>
<span id="q_${id}">0</span>
<button onclick="qty('${id}',1)">+</button>
</div>
<label class="pack">
<input type="checkbox" onchange="setPack('${id}',this)"> ðŸ“¦ Pack
</label>
</div>
</div>`;
});
});
}

/* CART OPS */
function setPlate(id,price,btn){
cart[id].price=Math.round(price);
btn.parentElement.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
calc();
}
function qty(id,d){
cart[id].qty+=d;
if(cart[id].qty<0)cart[id].qty=0;
document.getElementById("q_"+id).innerText=cart[id].qty;
calc();
}
function setPack(id,c){cart[id].pack=c.checked}

function calc(){
total=0;
Object.values(cart).forEach(i=>total+=i.price*i.qty);
totalSpan.innerText=total;
}

/* PLACE ORDER (BILL = KITCHEN SLIP) */
function placeOrder(){
if(total===0){alert("No items selected");return;}

sales+=total;
orders++;
localStorage.setItem("sales",sales);
localStorage.setItem("orders",orders);

let items=Object.values(cart).filter(i=>i.qty>0);

let bill=`
<div style="font-family:Arial;width:260px">
<h3 style="text-align:center">KssS Restaurant</h3>
<hr>
<b>Table:</b> ${tableNo}<br>
${items.map(i=>`<p>${i.pack?"ðŸ“¦ ":""}${i.name} Ã— ${i.qty}</p>`).join("")}
<hr>
<b>Total â‚¹${total}</b>
</div>`;

let w=window.open("","","width=300,height=500");
w.document.write(bill);
w.document.close();
setTimeout(()=>{w.print();w.close();},500);

loadMenu();total=0;totalSpan.innerText=0;
}

/* ADMIN */
function adminLogin(){
let p=prompt("Admin Password");
if(p==="1234"){
admin.style.display="block";
document.getElementById("orderCount").innerText=orders;
document.getElementById("salesTotal").innerText=sales;
loadPriceEditor();
}else alert("Wrong password");
}

function loadPriceEditor(){
let box=document.getElementById("priceEdit");
box.innerHTML="";
menuData.forEach(cat=>{
cat.items.forEach(i=>{
box.innerHTML+=`
<div class="priceRow">
<span>${i.name}</span>
<input type="number" value="${i.price}" onchange="updatePrice('${i.name}',this.value)">
</div>`;
});
});
}

function updatePrice(name,val){
menuData.forEach(c=>{
c.items.forEach(i=>{
if(i.name===name)i.price=Number(val);
});
});
localStorage.setItem("menuData",JSON.stringify(menuData));
loadMenu();
}

function resetDaily(){
if(confirm("Reset today data?")){
sales=0;orders=0;
localStorage.removeItem("sales");
localStorage.removeItem("orders");
document.getElementById("orderCount").innerText=0;
document.getElementById("salesTotal").innerText=0;
}
}

loadMenu();
</script>

</body>
</html>
